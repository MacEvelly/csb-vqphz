(this["webpackJsonpreact-template-userflow-ncaa-3d"]=this["webpackJsonpreact-template-userflow-ncaa-3d"]||[]).push([[0],{77:function(e,t,n){},78:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(22),o=n.n(c),s=n(19),a=n(81),i=n(6);function u(){var e=Object(r.useRef)(),t=Object(r.useRef)(),n=Object(r.useRef)();return Object(r.useEffect)((function(){e.current.lookAt=[1,1,1]}),[e,t]),Object(i.jsxs)("group",{children:[Object(i.jsx)("ambientLight",{intensity:.3}),Object(i.jsx)("directionalLight",{ref:n,intensity:.5,position:[0,3,3],castShadow:!0,"shadow-mapSize-height":1024,"shadow-mapSize-width":1024}),Object(i.jsx)("spotLight",{lookAt:[1,1,1],ref:e,angle:.25,penumbra:.5,intensity:.2,position:[1,4,2],"shadow-mapSize-width":1024,"shadow-mapSize-height":1024,castShadow:!0,"shadow-bias":-.001}),Object(i.jsx)("spotLight",{ref:t,angle:.25,penumbra:.5,intensity:.2,position:[-1,4,2],"shadow-mapSize-width":1024,"shadow-mapSize-height":1024,castShadow:!0,"shadow-bias":-.001})]})}var l=Object(r.memo)(u),f=n(85),d=n(84),j=n(8),b=n(16),h=n.n(b),p=n(21),O=n(10),m=n(45),x=n(53),g=n(83),v=n(54),S=function(e){var t=e.children;return Object(i.jsx)("section",{children:t})},y=function(){console.log("Splash Screen");var e=B((function(e){return e.BtnGoToSection}));return Object(i.jsx)(S,{children:Object(i.jsxs)("div",{children:[Object(i.jsx)("h2",{children:"Splash Screen"}),Object(i.jsx)("button",{onClick:e("FaceScan"),children:"Start Experience"})]})})},A=function(){console.log("Face Scan");var e=B((function(e){return e.BtnGoToSection}));return Object(i.jsx)(S,{children:Object(i.jsxs)("div",{children:[Object(i.jsx)("h2",{children:"Face Scan"}),Object(i.jsx)("button",{onClick:e("ModelEditor"),children:"Start Experience"})]})})},w=function(){console.log("Model Editor");var e=B((function(e){return e.avatar})),t=B((function(e){return e.setAvatar})),n=B((function(e){return e.dance})),c=B((function(e){return e.setDance})),o=B((function(e){return e.colors})),s=B((function(e){return e.color1})),a=B((function(e){return e.setColor1})),u=B((function(e){return e.color2})),l=B((function(e){return e.setColor2})),f=Object(r.useRef)(),d=Object(r.useRef)(),j=Object(r.useRef)(),b=Object(r.useState)(0),h=Object(O.a)(b,2),p=h[0],m=h[1],x=function(e){m(e>0?p+e>=3?3:p+e:p+e<=0?0:p+e)};return Object(r.useEffect)((function(){d.current.style.opacity=1,j.current.style.opacity=1,0===p&&(d.current.style.opacity=0),3===p&&(j.current.style.opacity=0)}),[p]),Object(i.jsx)(S,{children:Object(i.jsxs)("div",{children:[Object(i.jsxs)("ul",{ref:f,className:"CustomHolder",style:{transform:"translateX(".concat(100*-p,"%)")},children:[Object(i.jsxs)("li",{children:[Object(i.jsx)("h3",{children:"Avatar"}),Object(i.jsx)("ul",{children:[1,2,3,4].map((function(n){return Object(i.jsx)("li",{children:Object(i.jsx)("img",{className:n===e?"active":null,onClick:function(){return t(n)},src:"https://via.placeholder.com/50x90.png?text=Body+".concat(n),alt:"img".concat(n)})},"avatar"+n)}))})]}),Object(i.jsxs)("li",{children:[Object(i.jsx)("h3",{children:"Color 1"}),Object(i.jsx)("ul",{className:"swatches",children:o.map((function(e,t){return Object(i.jsx)("li",{className:t===s?"active":null,onClick:function(){return a(t)},style:{backgroundColor:e}},"color1"+t)}))})]}),Object(i.jsxs)("li",{children:[Object(i.jsx)("h3",{children:"Color 2"}),Object(i.jsx)("ul",{className:"swatches",children:o.map((function(e,t){return Object(i.jsx)("li",{className:t===u?"active":null,onClick:function(){return l(t)},style:{backgroundColor:e}},"color2"+t)}))})]}),Object(i.jsxs)("li",{children:[Object(i.jsx)("h3",{children:"Dance"}),Object(i.jsx)("ul",{children:[1,2,3,4].map((function(e){return Object(i.jsx)("li",{children:Object(i.jsx)("img",{className:e===n?"active":null,onClick:function(){return c(e)},src:"https://via.placeholder.com/50x90.png?text=Dance+".concat(e),alt:"img".concat(e)})},"dance"+e)}))})]})]}),Object(i.jsxs)("nav",{children:[Object(i.jsxs)("h3",{ref:d,onClick:function(){return x(-1)},children:["<"," Prev"]}),Object(i.jsxs)("h3",{ref:j,onClick:function(){return x(1)},children:["Next ",">"]})]})]})})},C={SplashScreen:Object(i.jsx)(y,{}),FaceScan:Object(i.jsx)(A,{}),ModelEditor:Object(i.jsx)(w,{})},E=Object.keys(C),k=E[2],F=C[k],R=["#66AFD4","#0057B8","#001963","#593217","#008F00","#00533A","#EDDBA9","#E1AD43","#F6DA4A","#FF8200","#FE5C00","#C85100","#E21833","#C41E3A","#800000","#531B93","#FFFFFF","#C0C0C0","#777777","#000000"],B=Object(m.a)((function(e,t){return{init:function(){console.log("init"),t().ARSupportCheck(),t().debugMode(!0),t().getURLVars(window.location)},getURLVars:function(e){var n=new URLSearchParams(e.search).get("f"),r="https://fanscan-bucket.s3.amazonaws.com/headmesh/".concat(n,".glb");n&&function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.setRequestHeader("Accept","*/*"),n.onprogress=function(e){return"2"===e.target.status.toString()[0]?(n.abort(),t(!0)):(n.abort(),t(!1))},n.send("")}(r,(function(e){e?(console.log("Good url.  Face: ",n),t().setFaceMesh(r)):console.log("Bad url")}))},showLeva:0,debugMode:function(){document.getElementById("debug")&&document.getElementById("debug").remove();var n=document.createElement("div");n.id="debug",n.innerHTML=.1,n.onclick=function(){return e((function(e){return{showLeva:!t().showLeva}}))},n.style.cssText="\n          cursor: pointer;\n          color:white;\n          position:absolute;\n          top:5px;\n          left:5px;\n          height:45px;\n          width:45px;\n          opacity:0.3;\n          z-index:1000;\n          background:#000;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          user-select: none;  \n          border-radius: 15px;\n      ",document.body.appendChild(n)},FaceMesh:"https://fanscan-bucket.s3.amazonaws.com/headmesh/Face.glb",setFaceMesh:function(t){return e((function(e){return{FaceMesh:t}}))},BodyMesh:null,setBodyMesh:function(t){return e((function(e){return{BodyMesh:t}}))},SceneMesh:null,setSceneMesh:function(t){return e((function(e){return{SceneMesh:t}}))},FirstName:null,setFirstName:function(t){e((function(e){return{FirstName:t}}))},LastName:null,setLastName:function(t){return e((function(e){return{LastName:t}}))},Email:null,setEmail:function(t){return e((function(e){return{Email:t}}))},Terms:!1,setTerms:function(t){return e((function(e){return{Terms:t}}))},avatar:null,setAvatar:function(n){e((function(e){return{avatar:n}})),t().setBodyIndex(n)},accessory:null,setAccessory:function(t){return e((function(e){return{accessory:t}}))},dance:null,setDance:function(n){e((function(e){return{dance:n}})),t().setActionIndex(n)},colors:R,color1:0,setColor1:function(t){e((function(e){return{color1:t}}))},color2:1,setColor2:function(t){return e((function(e){return{color2:t}}))},Friend1:null,setFriend1:function(t){return e((function(e){return{Friend1:t}}))},Friend2:null,setFriend2:function(t){return e((function(e){return{Friend2:t}}))},Friend3:null,setFriend3:function(t){return e((function(e){return{Friend3:t}}))},GroupCapture:{FaceHolder:/Holder/,Assets:/Asset/,Body:/body/gi},Groups:{},Nodes:null,setNodes:function(n){e((function(e){return{Nodes:n}}));var r=t().Groups;console.log(n),Object.entries(t().GroupCapture).forEach((function(e){var t=Object(O.a)(e,2),c=t[0],o=t[1],s=Object.entries(n).filter((function(e){var t=Object(O.a)(e,2),n=t[0];t[1];return o.test(n)})),a={};s.forEach((function(e){var t=Object(O.a)(e,2),n=t[0],r=t[1];r.visible=!1;var c=n.replace(/[^_]*_([^-]*)-.*/,"$1");a[c]?a[c].push(r):a[c]=[r]})),0!==Object.keys(a).length&&(r[c]=a)})),e((function(e){return{Groups:r}})),console.log(t().Groups),r.Assets&&e((function(e){return{Assets:r.Assets}}))},headHolder:null,setHeadHolder:function(t){return e((function(e){return{headHolder:t}}))},Actions:["Dance1","Dance2","Dance3","Dance4","Dance5","Dance6","Dance7","Idle","T-Pose"],setActions:function(t){return e((function(e){return{Actions:t}}))},ActionIndex:7,setActionIndex:function(t){return e((function(e){return{ActionIndex:t}}))},Body:["Character_Aunt_02","Character_Daughter_01","Character_Father_01","Character_Mother_01","Character_SchoolBoy_01","Character_SchoolGirl_01","Character_ShopKeeper_01","Character_Son_01","Character_Uncle_02"],setBody:function(t){return e((function(e){return{Body:t}}))},BodyIndex:0,setBodyIndex:function(t){return e((function(e){return{BodyIndex:t}}))},Assets:{Cone:[],Cube:[],Sphere:[],Torus:[],None:[]},setAssets:function(t){return e((function(e){return{Assets:t}}))},AssetIndex:0,setAssetIndex:function(n){var r=t().Assets;Object.entries(r).forEach((function(e){var t=Object(O.a)(e,2),c=t[0];t[1];r[c].forEach((function(e){e.visible=c===n}))})),e((function(e){return{AssetIndex:n}}))},section:F,sectionObj:C,sectionKey:k,sectionKeys:E,setSection:function(n){var r=t().sectionObj[n];e((function(e){return{section:r,sectionKey:n}}))},BtnGoToSection:function(e){return Object(r.useCallback)((function(){if(!C[e])return console.log("".concat(e," is not in phases")),void console.log(t().sectionKeys);console.log("Going To:",e),t().setSection(e)}),[e])},gl:null,arBtn:null,setGL:function(t){console.log("GL Set:".concat(t)),e((function(e){return{gl:t}}))},scene:null,setScene:function(t){console.log("Scene Set:".concat(t)),e((function(e){return{scene:t}}))},camera:null,setCamera:function(t){console.log("Camera Set:".concat(t)),e((function(e){return{camera:t}}))},controls:null,setControls:function(t){console.log("Controls Set:".concat(t)),e((function(e){return{controls:t}}))},controlsEnabled:!0,CameraTo:function(n,r,c){Object(x.a)({newZoom:c,newPos:n,newLookAt:r,enabled:!0,onRest:function(t){t.enabled;e((function(e){return{controlsEnabled:!0}}))},onStart:function(t){t.enabled;e((function(e){return{controlsEnabled:!0}}))},onChange:function(e){var n=e.newPos,r=e.newZoom;t().camera.current.fov=r,t().camera.current.position.set(n[0],n[1],n[2])}})},ARSupport:!1,ARSupportCheck:function(){var t=Object(p.a)(h.a.mark((function t(){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=navigator.xr&&navigator.xr.isSessionSupported,!t.t0){t.next=5;break}return t.next=4,navigator.xr.isSessionSupported("immersive-ar");case 4:t.t0=t.sent;case 5:n=t.t0,console.log("ARSupportCheck: "+n),e((function(e){return{ARSupport:n}}));case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),ARSession:null,ARStarted:function(){var n=Object(p.a)(h.a.mark((function n(r){var c;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("ARStarted"+r),c=t().gl,n.next=4,c.xr.setSession(r);case 4:e((function(e){return{ARSession:r}}));case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),AREnded:function(){console.log("AREnded")},ARActivate:function(){var e=Object(p.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("ARActivate"),e.prev=1,e.next=4,navigator.xr.requestSession("immersive-ar",{requiredFeatures:["hit-test","dom-overlay"],domOverlay:{root:document.body}}).then((function(e){return t().ARStarted(e)}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(){return e.apply(this,arguments)}}(),BtnEnterAR:function(){return Object(r.useCallback)((function(){return t().ARActivate()}),[])},USDZLink:null,SetUSDZ:function(){var t=Object(p.a)(h.a.mark((function t(n){var r,c,o,s;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("SetUSDZ"),r=new v.a,t.next=4,r.parse(n);case 4:c=t.sent,o=new Blob([c],{type:"application/octet-stream"}),(s=document.createElement("a")).appendChild(document.createElement("img")),s.rel="ar",s.href=URL.createObjectURL(o),s.download="asset.usdz",s.click(),e((function(e){return{USDZLink:s}}));case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),BtnUSDZ:function(){return Object(r.useCallback)((function(){t().SetUSDZ(t().scene)}),[])},grabModel:function(e){switch(e.type){case"Group":case"Object3D":return Object(i.jsx)("group",{name:e.name,position:e.position,rotation:e.rotation,scale:e.scale,children:e.children.map((function(e){return t().makeModel(e)}))},e.uuid);case"Mesh":return Object(i.jsx)("mesh",{name:e.name,material:e.material,geometry:e.geometry,position:e.position,rotation:e.rotation,scale:e.scale},e.uuid);case"PointLight":return Object(i.jsx)("pointLight",{intensity:.1*e.intensity,position:e.position,rotation:e.rotation,scale:e.scale},e.uuid);case"PerspectiveCamera":return Object(i.jsx)("perspectiveCamera",Object(j.a)({},e),e.uuid);default:return console.log(e),null}},ModelLibrary:function(e){var n=Object(g.a)(e).nodes,r={};return Object.keys(n).forEach((function(e){"Scene"!==e&&(r[e]=t().grabModel(n[e]))})),r}}})),M=n(20);function D(){var e=Object(r.useRef)(),t=Object(r.useRef)(),n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-25,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.001;return{value:e,min:n,max:t,step:r}},c=Object(M.c)("Camera",{x:n(0),y:n(0),z:n(7),fov:n(25)},{collapsed:!0}),o=c.x,a=c.y,u=c.z,l=c.fov,j=Object(M.c)("Target / Orbit Pivot",{tX:n(0,5,-5),tY:n(.5,5,-5),tZ:n(0,5,-5)},{collapsed:!0}),b=j.tX,h=j.tY,p=j.tZ,O=B((function(e){return e.setControls}));Object(r.useEffect)((function(){return O(t)}),[t,O]);var m=Object(s.d)(),x=m.gl,g=m.scene,v=m.camera,S=B((function(e){return e.setGL}));Object(r.useEffect)((function(){return S(x)}),[x,S]);var y=B((function(e){return e.setScene}));Object(r.useEffect)((function(){return y(g)}),[g,y]);var A=B((function(e){return e.setCamera}));return Object(r.useEffect)((function(){return A(v)}),[v,A]),Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(f.a,{makeDefault:!0,ref:e,position:[o,a,u],fov:l,near:1,far:10}),Object(i.jsx)(d.a,{ref:t,camera:e.current,target:[b,h,p],maxPolarAngle:Math.PI/2})]})}var L=Object(r.memo)(D),I=n(80);function _(e){var t=Object(r.useRef)(),n=B((function(e){return e.setNodes})),c=B((function(e){return e.Body})),o=B((function(e){return e.BodyIndex})),s=Object(g.a)("./glb/Characters.glb"),a=s.nodes,u=s.animations,l=Object(I.a)(u,t),f=l.actions,d=l.names,b=B((function(e){return e.ActionIndex})),h=B((function(e){return e.setActions})),p=Object.entries(a).filter((function(e){var t=Object(O.a)(e,2),n=t[0],r=t[1];return/head/g.test(n)&&"Bone"===r.type}));return B((function(e){return e.setHeadHolder}))(p[0][1]),Object(r.useEffect)((function(){return n(a)}),[n,a]),Object(r.useEffect)((function(){return h(d)}),[h,d]),Object(r.useEffect)((function(){return f[d[b]].reset().fadeIn(.3).play(),function(){return f[d[b]].fadeOut(.3)}}),[b,f,d]),Object(i.jsx)("group",Object(j.a)(Object(j.a)({ref:t},e),{},{dispose:null,children:Object(i.jsx)("group",{name:"Scene",children:Object(i.jsxs)("group",{name:"MainArmature",position:[0,0,0],rotation:[Math.PI/2,0,0],scale:[.01,.01,.01],userData:{name:"MainArmature"},children:[Object(i.jsx)("primitive",{object:a.root}),Object(i.jsx)("skinnedMesh",{castShadow:!0,receiveShadow:!0,name:c[o],geometry:a[c[o]].geometry,skeleton:a[c[o]].skeleton,material:a[c[o]].material,userData:{name:c[o]}})]})})}))}function G(e){var t=Object(r.useRef)(),n=Object(r.useRef)(),c=B((function(e){return e.FaceMesh})),o=Object(g.a)(c).nodes,s=B((function(e){return e.headHolder}));return Object(r.useEffect)((function(){s&&(n.current.position.set(-.49,-.55,.27),n.current.rotation.set(-.55,0,0),t.current.scale.set(125,125,125),s.add(t.current))}),[s]),o.mesh_0.material.metalness=0,Object(i.jsx)("group",Object(j.a)(Object(j.a)({ref:t},e),{},{dispose:null,children:Object(i.jsx)("mesh",{castShadow:!0,receiveShadow:!0,ref:n,geometry:o.mesh_0.geometry,material:o.mesh_0.material})}))}g.a.preload("./glb/Characters.glb");var N="#009fdb";function T(e){return Object(i.jsxs)("group",{children:[Object(i.jsxs)("mesh",{castShadow:!0,receiveShadow:!0,position:[0,-.125,0],children:[Object(i.jsx)("cylinderBufferGeometry",{attach:"geometry",args:[.75,.75,.25,32]}),Object(i.jsx)("meshStandardMaterial",{color:N})]}),Object(i.jsxs)("mesh",{castShadow:!0,receiveShadow:!0,rotation:[.5*-Math.PI,0,0],position:[0,-.25,0],children:[Object(i.jsx)("planeBufferGeometry",{attach:"geometry",args:[200,200]}),Object(i.jsx)("meshStandardMaterial",{attach:"material",color:N})]})]})}function H(){console.count("scene3D");var e=B((function(e){return e.colors})),t=B((function(e){return e.color1})),n=B((function(e){return e.color2}));return Object(i.jsxs)(s.a,{colorManagement:!0,shadowMap:!0,pixelRatio:window.devicePixelRatio,children:[Object(i.jsx)("fog",{attach:"fog",args:["#0057b8",7.5,10]}),Object(i.jsx)(l,{}),Object(i.jsx)(L,{}),Object(i.jsxs)(r.Suspense,{fallback:null,children:[Object(i.jsx)(_,{}),Object(i.jsx)(T,{}),Object(i.jsx)(G,{}),Object(i.jsx)(a.a,{args:[.25,.25,.25],position:[.75,.8,0],children:Object(i.jsx)("meshPhongMaterial",{attach:"material",color:e[t]})}),Object(i.jsx)(a.a,{args:[.25,.25,.25],position:[.75,.5,0],children:Object(i.jsx)("meshPhongMaterial",{attach:"material",color:e[n]})})]})]})}var P=n(82);function U(){var e=B((function(e){return e.sectionKey})),t=B((function(e){return e.section}));return Object(i.jsx)("main",{className:"HUD ".concat(e),children:Object(i.jsx)(P.a,{exitBeforeEnter:!0,children:t})})}function z(){var e=B((function(e){return e.sectionKeys})),t=B((function(e){return e.BtnGoToSection})),n=B(),r={},c=B((function(e){return e.Actions})),o=B((function(e){return e.setActionIndex}));c.forEach((function(e,t){return r[e]=Object(M.b)((function(){return o(t)}))})),Object(M.c)("Animation",r,{collapsed:!1});var s={},a=B((function(e){return e.Assets})),u=B((function(e){return e.setAssetIndex}));Object.keys(a).forEach((function(e,t){return s[e]=Object(M.b)((function(){return u(e)}))})),Object(M.c)("Accessories",s,{collapsed:!1});var l={},f=B((function(e){return e.Body})),d=B((function(e){return e.setBodyIndex}));f.forEach((function(e,t){return l[e]=Object(M.b)((function(){return d(t)}))})),Object(M.c)("Bodys",l,{collapsed:!1});var j={};e.map((function(e){return j[e]=Object(M.b)(t(e))})),Object(M.c)("Go To Section overlay",j,{collapsed:!0}),Object(M.c)({"Log useApp()":Object(M.b)((function(){return console.log(n)}))});var b=B((function(e){return e.showLeva}));return Object(i.jsx)(M.a,{collapsed:!0,hidden:!b})}n(77);function Z(){var e=B((function(e){return e.init}));return Object(r.useEffect)((function(){return e()}),[e]),Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(H,{}),Object(i.jsx)(U,{}),Object(i.jsx)(z,{})]})}var K=document.getElementById("App");o.a.render(Object(i.jsx)(r.StrictMode,{children:Object(i.jsx)(Z,{})}),K)}},[[78,1,2]]]);
//# sourceMappingURL=main.61b52474.chunk.js.map